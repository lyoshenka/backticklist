<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Backtick.io Custom Commands</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.4.1/pure-min.css">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="content">
      <h1>Backtick.io Custom Commands</h1>
      <table id="list" class="pure-table pure-table-striped">
        <thead>
          <th>Name</th>
          <th>Description</th>
          <th>Link</th>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="http://www.datatables.net/release-datatables/media/js/jquery.dataTables.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var forksUrl = 'https://api.github.com/gists/6859173/forks',
            auth = '',//'?access_token=78d729db8f64c986906175d177dbcb33e024d7ba',
            $list = $('#list');

        $list.dataTable({
          iDisplayLength: 10,
          bLengthChange: false,
          sDom: 'lfprti'
        });

        $.getJSON(forksUrl + auth)
          .done(function(data) {
            $.each(data, function(index, forkItem) {
              $.getJSON(forkItem.url + auth)
                .done(function(fork) {
                  var desc = JSON.parse(fork.files['command.json'].content);
                  if (desc.name == 'Example Command') {
                    return;
                  }
                  $list.dataTable().fnAddData([
                    desc.name,
                    desc.description,
                    '<a href="' + fork.html_url + '">' + fork.user.login + '/' + fork.id + '</a>'
                  ]);
                })
                .fail(function(data) {
                  console.log(data.responseJSON.message);
                });
            })
          })
          .fail(function(data) {
            alert(data.responseJSON.message);
          });
      });
    </script>
  </body>
</html>